---
layout: post
title: Mesos 使用体验（一）
tag: Mesos
keywords: Mesos
---

阅读了一些 Mesos 相关的文档后，尝试使用 Mesos，进行了一些测试。

本文所使用的架构是 Mesos 单节点的架构，没有 HA 功能，测试在虚拟机中进行。

## 测试架构

* mesos-master * 1
* mesos-slave * 2
* marathon * 1 （运行在 mesos-master 上）

测试过程主要遵循 [http://mesos.apache.org/gettingstarted/](http://mesos.apache.org/gettingstarted/)，使用 CentOS 6.6 进行测试。

首先保证安装了 wget、tar。

## Mesos 安装

1. 下载 mesos：

    有两种下载方式：
    * 从 [Apache](http://mesos.apache.org/downloads/) 上下载稳定版本，官方推荐这个方式，笔者也使用了这个方式：

        ```
        $ wget http://www.apache.org/dist/mesos/0.24.0/mesos-0.24.0.tar.gz
        $ tar -zxf mesos-0.24.0.tar.gz
        ```
    * 从 [git 仓库](https://git-wip-us.apache.org/repos/asf?p=mesos.git) 下载，官方仅建议高级用户使用这个方法：

        ```
        $ git clone https://git-wip-us.apache.org/repos/asf/mesos.git
        ```
1. 获取几个需要用的仓库：

    ```
    $ sudo wget -O /etc/yum.repos.d/slc6-devtoolset.repo http://linuxsoft.cern.ch/cern/devtoolset/slc6-devtoolset.repo
    $ sudo wget http://repos.fedorapeople.org/repos/dchen/apache-maven/epel-apache-maven.repo -O /etc/yum.repos.d/epel-apache-maven.repo
  
    # 添加 WANdisco SVN 仓库文件：
    $ sudo vi /etc/yum.repo.d/wandisco-svn.repo
  
    # 在文件中添加如下内容：
    [WANdiscoSVN]
    name=WANdisco SVN Repo 1.8
    enabled=1
    baseurl=http://opensource.wandisco.com/centos/6/svn-1.8/RPMS/$basearch/
    gpgcheck=1
    gpgkey=http://opensource.wandisco.com/RPM-GPG-KEY-WANdisco
    ```
1. 安装所需要的开发工具套件 `Development Tools`：

    ```
    $ sudo yum groupinstall -y "Development Tools"
    ```
1. 安装 `devtoolset-2-toolchain`，它包括了 Mesos 所需要的 GCC 4.8.2 和其他相关的包：

    ```
    $ sudo yum install -y devtoolset-2-toolchain
    ```
1. 安装 Mesos 的其他依赖：

    ```
    $ sudo yum install -y apache-maven python-devel java-1.7.0-openjdk-devel \
    zlib-devel libcurl-devel openssl-devel cyrus-sasl-devel \
    cyrus-sasl-md5 apr-devel subversion-devel apr-util-devel
    ```
1. 启用 devtoolset-2：

    ```
    $ scl enable devtoolset-2 bash
  
    # 确认 gcc++ 的版本大于 4.8 ？？？？？？？
    $ g++ --version
    gcc (GCC) 4.8.2 20140120 (Red Hat 4.8.2-15)
    Copyright (C) 2013 Free Software Foundation, Inc.
    This is free software; see the source for copying conditions.  There is NO
    warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
    ```


## Master & Slave 的启动

## 添加框架（Marathon）

## 任务运行
